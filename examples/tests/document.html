<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Document API Test</title>
		<meta charset="utf-8">
		<script src="https://cdn.rawgit.com/mrdoob/three.js/r74/build/three.min.js"></script>
		<script src="../../dist/altspace.js"></script>
		<style>
			html, body, video { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
			body { border: 1px solid red; background-color: white; }
			#cursorFollow { position: absolute; width: 50px; height: 50px; background-color: green; top: 0; right: 0; }
			li { font: 20pt sans-serif; list-style-type: none }
			#logList { position: absolute; }
		</style>
	</head>
	<body>
		<ol id="logList"></ol>
		<div id="cursorFollow"></div>
		<script>
			function log() {
				var li = document.createElement('li');
				var args = Array.prototype.slice.apply(arguments);
				args.unshift(Date.now());
				li.textContent = args.join(' ');
				logList.insertBefore(li, logList.firstChild);
			}

			var sim = new altspace.utilities.Simulation();
			var cube = new THREE.Mesh(
				new THREE.BoxGeometry(100, 100, 100),
				new THREE.MeshBasicMaterial({ color: 'red' })
			);
			sim.scene.add(cube);

			function logEvent(event) {
				log(
					event.type,
					event.button,
					event.buttons,
					event.clientX, event.clientY,
					event.touches && event.touches[0] && (event.touches[0].clientX + ' ' + event.touches[0].clientY),
					JSON.stringify(event.ray)
				);
			}
			cube.addEventListener('cursordown', logEvent);
			cube.addEventListener('cursorup', logEvent);
			if (/cursormove/.test(location.search)) {
				sim.scene.addEventListener('cursormove', logEvent);
			}

			var isMobile = /mobile/i.test(navigator.userAgent);
			if (altspace.addEventListener) {
				altspace.addEventListener('touchpadup', logEvent);
				altspace.addEventListener('touchpaddown', logEvent);
			}
			document.body.addEventListener('click', logEvent);
			document.body.addEventListener('mouseup', logEvent);
			document.body.addEventListener('mousedown', logEvent);
			document.body.addEventListener('touchstart', logEvent);
			document.body.addEventListener('touchend', logEvent);
			document.body.addEventListener('touchmove', logEvent);
			document.body.addEventListener('mousemove', function (e) {
				logEvent(e);
				cursorFollow.textContent = e.clientX + ', ' + e.clientY;
				cursorFollow.style.left = (e.clientX + 10) + 'px';
				cursorFollow.style.top = (e.clientY + 10) + 'px';
			});
		</script>
	</body>
</html>

